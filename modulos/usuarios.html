<form id="frmUsuario" data-accion="nuevo" data-idusuario="0">
    <div class="card text-bg-dark mb-3" style="min-width: 700px;">
        <div class="card-header">
            <div class="d-flex">
                Registro de Usuarios
                <div class="ms-auto">
                    <button type="button" data-form="usuarios" class="btn-close btn-close-white" aria-label="Close"></button>
                </div>
            </div>
        </div>
        <div class="card-body">
            <div class="row p-1">
                <div class="col-3 col-md-2">USUARIO </div>
                <div class="col-9 col-md-4">
                    <input type="text" class="form-control" id="txtUsuario" name="txtUsuario" required>
                </div>
            </div>
            <div class="row p-1">
                <div class="col-3 col-md-2">CLAVE </div>
                <div class="col-9 col-md-6">
                    <input type="text" class="form-control" id="txtClaveUsuario" name="txtClaveUsuario" required>
                </div>
            </div>
            <div class="row p-1">
                <div class="col-3 col-md-2">NOMBRE</div>
                <div class="col-9 col-md-10">
                    <input type="text" class="form-control" id="txtNombreUsuario" name="txtNombreUsuario" required>
                </div>
            </div>
            <div class="row p-1">
                <div class="col-3 col-md-2">DIRECCION </div>
                <div class="col-9 col-md-4">
                    <input type="text" class="form-control" id="txtDireccionUsuario" name="txtDireccionUsuario" required>
                </div>
            </div>
            <div class="row p-1">
                <div class="col-3 col-md-2">TELEFONO </div>
                <div class="col-9 col-md-6">
                    <input type="email" class="form-control" id="txtTelefonoUsuario" name="txtTelefonoUsuario" required>
                </div>
            </div>
            <div class="row p-1">
                <div class="col-12 col-md-4 text-center d-grid gap-2">
                    <button type="submit" class="btn btn-outline-primary">Guardar</button>
                </div>
                <div class="col-12 col-md-4 text-center d-grid gap-2">
                    <button type="reset" class="btn btn-outline-warning">Nuevo</button>
                </div>
                <div class="col-12 col-md-4 text-center d-grid gap-2">
                    <button type="button" class="btn btn-outline-success" onclick="abrirVentana('busqueda_alumnos')">BUSCAR</button>
                </div>
            </div>
        </div>
    </div>
</form>
<script>
    
    document.querySelector('#frmUsuario').addEventListener('submit', (e)=>{
        e.preventDefault();
        
        let datos = {
            accion : frmUsuario.dataset.accion,
            idUsuario : frmUsuario.dataset.idusuario,
            usuario : txtUsuario.value,
            clave : txtClaveUsuario.value,
            nombre : txtNombreUsuario.value,
            direccion : txtDireccionUsuario.value,
            telefono : txtTelefonoUsuario.value
        };
        enviarDatosUsuario(datos);
    });
    function enviarDatosUsuario(datos){
        fetch('/usuarios',{
                method : 'POST',
                body : JSON.stringify(datos)
            })
            .then(res => res.json())
            .then(data => {
                if( data.msg==='ok' ){
                    consultarUsuarios();
                    limpiarDatosUsuarios();
                }
            })
            .catch(err => console.log(err));
    }
    function modificarUsuario(usuario){
        frmUsuario.dataset.accion = 'modificar';
        frmUsuario.dataset.idusuario = usuario.idUsuario;
        txtUsuario.value = usuario.usuario;
        txtClaveUsuario.value = usuario.clave;
        txtNombreUsuario.value = usuario.nombre;
        txtDireccionUsuario.value = usuario.direccion;
        txtTelefonoUsuario.value = usuario.telefono;
    }
    function limpiarDatosUsuarios(){
        frmUsuario.dataset.accion = 'nuevo';
        frmUsuario.dataset.idusuario = '';
        txtUsuario.value = '';
        txtClaveUsuario.value = '';
        txtNombreUsuario.value = '';
        txtDireccionUsuario.value = '';
        txtTelefonoUsuario.value = '';
        }